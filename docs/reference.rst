.. _api-reference:

API reference of DiddiParser 2
==============================

This document explains the internal API of DiddiParser 2

``diddiparser.parser`` -- parser configurations
-----------------------------------------------

This Python module configures the main DiddiScript parser, and
some useful variables.

.. py:module:: diddiparser2.parser

.. py:class:: DiddiParser

   This class is the main DiddiScript parser.

   .. py:method:: __init__(self, file)
                  __init__(self, file, ignore_suffix=False)

      :param str file: The DiddiScript file to be parsed.
      :param bool ignore_suffix: If ``True``, tells DiddiParser to ignore the suffix mismatch.
   
      The constructor method. It reads the selected filename, and gets the commands via
      :py:meth:`diddiparser2.parser.DiddiParser.get_commands`.
   
   .. py:method:: get_commands(self)
   
      :return: A list of prepared commands.
      :rtype: list
      :raises diddiparser2.messages.error: When a syntax error is found.
      
      This function returns a list of DiddiScript commands, without comments. It can raise
      a compile error if there are missing semicolons (;).
   
   .. py:method:: executeline(self, line)
   
      :param str line: A line of DiddiScript code.
      :raises diddiparser2.messages.error: If the execution fails.
      
      Run a single line of code.
      
   .. py:method:: runfile(self)
      
      Runs :py:meth:`diddiparser2.parser.DiddiParser.executeline` for each line, and
      then prints a success message.

.. py:data:: TOOL_FUNCTIONS
   
   :type: tuple
   :value: ("load_module", "load_extension")
   
   A tuple of special DiddiScript functions.

.. py:data:: MODULE_FUNCTIONS

   :type: dict
   :value: {}
   
   A ``name: callable`` dictionary of loaded modules and extensions.
   It works to define the function name, and its interpretation.

``diddiparser.messages`` -- Tools for user/parser interactions
--------------------------------------------------------------

These functions are used by the parser (generated by ``diddiparser2.parser``)
to interact with you as the "interpreter". Also, you can use some of this
functions in your extensions.

.. py:module:: diddiparser2.messages

.. py:exception:: error

   An exception (which is a direct subclass of ``Exception``) raised when
   a function decided to stop the program.
   
.. py:function:: run_error(msg)
   
   :raises error: at the end of the function.
   
   Prints a "run error" in red, and stop the executions. This
   function is used when something in the execution failed. In
   most of the cases, this function is used by libraries.

.. py:function:: compile_error(msg)

   :raises error: at the end of the function.
   
   This function prints a "compile error" in red, and stop
   all the executions. This is commonly raised by the parser
   when a syntax error appears, a missing function is called,
   etc.
   
.. py:function:: show_warning(msg)

   This function prints a warning in yellow. It does not
   stop the execution.

.. py:function:: success_message()

   This function is called by the parser to tell the user
   that the execution finished succesfully.
